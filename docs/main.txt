‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏ö‡∏ô Linux (Ubuntu ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å) ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Janus WebRTC Server ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏™‡∏ï‡∏£‡∏µ‡∏°‡∏ú‡πà‡∏≤‡∏ô Web Browser üëå

‡∏ú‡∏°‡∏à‡∏∞‡πÅ‡∏¢‡∏Å‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏ä‡πà‡∏ß‡∏á:

‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Janus

‡∏™‡πà‡∏á‡∏™‡∏ï‡∏£‡∏µ‡∏°‡πÄ‡∏Ç‡πâ‡∏≤ Janus

‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏ú‡πà‡∏≤‡∏ô Web Browser

1) ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Janus ‡∏ö‡∏ô Linux (Ubuntu 20.04 / 22.04)
1.1 ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependency
sudo apt update
sudo apt install -y \
  git build-essential cmake \
  libmicrohttpd-dev libjansson-dev \
  libssl-dev libsrtp2-dev \
  libsofia-sip-ua-dev libglib2.0-dev \
  libopus-dev libogg-dev \
  libcurl4-openssl-dev liblua5.3-dev \
  libconfig-dev pkg-config gengetopt


‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ WebRTC + H264

sudo apt install -y libx264-dev

1.2 ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á libsrtp
git clone https://github.com/cisco/libsrtp.git
cd libsrtp
./configure --enable-openssl
make shared_library
sudo make install

1.3 ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞ build Janus
cd ~
git clone https://github.com/meetecho/janus-gateway.git
cd janus-gateway
sh autogen.sh
./configure --enable-post-processing
make
sudo make install
sudo make configs


‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

janus --version

2) ‡πÄ‡∏õ‡∏¥‡∏î Janus ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö Streaming
2.1 ‡πÄ‡∏õ‡∏¥‡∏î Janus server
janus


‡∏Ñ‡πà‡∏≤ default:

WebSocket: ws://IP:8188

HTTP: http://IP:8088/janus

‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà error ‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ üëç

3) ‡∏ß‡∏¥‡∏ò‡∏µ Streaming ‡πÄ‡∏Ç‡πâ‡∏≤ Janus
‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å A: ‡πÉ‡∏ä‡πâ RTSP / RTMP ‚Üí Janus (Streaming Plugin)

‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á CCTV / ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠

‡πÅ‡∏Å‡πâ‡πÑ‡∏ü‡∏•‡πå:

sudo nano /usr/local/etc/janus/janus.plugin.streaming.jcfg


‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á RTSP:

streaming: {
  rtsp-cam: {
    type = "rtsp"
    id = 1
    description = "RTSP Camera"
    audio = false
    video = true
    url = "rtsp://user:pass@IP:554/stream1"
  }
}


‡∏£‡∏µ‡∏™‡∏ï‡∏≤‡∏£‡πå‡∏ó Janus

‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å B: ‡∏™‡πà‡∏á‡∏à‡∏≤‡∏Å‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (WebRTC / RTMP ‚Üí FFmpeg ‚Üí Janus)

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á FFmpeg:

ffmpeg -re -i input.mp4 \
  -c:v libx264 -preset veryfast -tune zerolatency \
  -f rtp rtp://JANUS_IP:5004


(‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö rtp plugin)

4) ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π Streaming ‡∏ú‡πà‡∏≤‡∏ô Web Browser üåê
4.1 ‡πÉ‡∏ä‡πâ‡∏´‡∏ô‡πâ‡∏≤ Demo ‡∏Ç‡∏≠‡∏á Janus (‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏∏‡∏î)

‡πÄ‡∏õ‡∏¥‡∏î:

http://JANUS_IP:8088/janus/demos/streaming.html


‡∏Å‡∏î Start

‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Stream ID (‡πÄ‡∏ä‡πà‡∏ô 1)

‡∏î‡∏π‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (WebRTC, latency ‡∏ï‡πà‡∏≥‡∏°‡∏≤‡∏Å)

üëâ ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö Chrome / Edge / Firefox

4.2 ‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô WebSocket

‡∏ñ‡πâ‡∏≤ Janus ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ö WS:

http://JANUS_IP/janus/demos/streaming.html?ws=wss://JANUS_IP:8989

5) ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° (‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢)
[ Mobile / CCTV ]
       |
   RTSP / WebRTC
       |
    [ Janus ]
       |
    WebRTC
       |
[ Web Browser ]


Latency ‡∏õ‡∏Å‡∏ï‡∏¥:

WebRTC: ~200‚Äì500 ms

RTSP ‚Üí Janus ‚Üí WebRTC: ~1s

6) ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö GPS ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤)

‡∏™‡πà‡∏á GPS ‡∏ú‡πà‡∏≤‡∏ô WebSocket / REST ‡πÅ‡∏¢‡∏Å channel

‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (Leaflet / Google Map)

Sync ‡∏Å‡∏±‡∏ö video stream (timestamp)